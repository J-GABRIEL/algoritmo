#include "stdafx.h"
#include "conio.h"
#include <string>
#include <iostream>
#include <stdlib.h>
using namespace std;
struct instrumento{
	string nombre;
	int codigo;
	string descripcion;
	string marca;
	int cantidad;
	string lugar;
};

struct partituras{
   int codigo;
   string nom;
   string autor;
};
struct usuario{
string usuarios;
string contra;
};

void crearArchivo(char nomArch[15])
{
	FILE *ptr;
	ptr= fopen("inventario.dat", "wb");
	fclose(ptr);
}

void solicitarDatos(instrumento reg) 
{	
	
	cout<<endl<< "Introducir Nombre:";
	do{
		getline(cin,reg.nombre);
	}while(reg.nombre.length() == 0);
	cout<< "codigo:";
	cin>> reg.codigo;
	cout<<"descripcion:";	
	do{
		getline(cin, reg.descripcion);
	}while(reg.descripcion.length() == 0);
	cout<<"marca:";	
	do{
		getline(cin, reg.marca);
	}while(reg.marca.length() == 0);

	cout<<"cantidad:";
	cin>>reg.cantidad;

	cout<<"lugar:";	
	do{
		getline(cin, reg.lugar);
		}while(reg.lugar.length() == 0);
     system("cls");

}

void mostrarRegistro(instrumento reg, int nroReg)
{
	cout<<endl<< nroReg<<".-"<< reg.nombre<< "         "<<reg.codigo<< "    "<< reg.descripcion<<"   "<<reg.marca<<"   "<<reg.cantidad<<"    "<<reg.lugar;
}

void adicionarRegistro(char nomArch[15])
{
	FILE *ptr;
	instrumento reg;
	ptr= fopen(nomArch, "ab"); 
	solicitarDatos(reg);
	fwrite(&reg, sizeof(struct instrumento),1,ptr);
	fclose(ptr);
}

void listarArchivo(char nomArch[15])
{
	FILE *ptr;
	instrumento reg;
	int cont=0;
	ptr= fopen(nomArch,"rb");
	if(ptr == NULL)
	{
		cout<< "EL archivo no existe...";
	}
	else
	{
		cout<<endl<<"   ** LISTADO DE INSTRUMENTOS **";
		cout<<endl<<" Nombre      codigo      descripcion      marca   cantidad     lugar";
		cout<<endl<<"----------------------------";
		fread(&reg, sizeof(struct instrumento),1,ptr);
		while(!feof(ptr))
		{
			if("inventario.dat" == 0)
			{
				mostrarRegistro(reg,cont+1);
			}
			fread(&reg, sizeof(struct instrumento),1,ptr);
			cont++;
		}
		fclose(ptr);
	}cout<<endl;
}
void instru(instrumento reg)
{
	int opcion;
	
	do{
	cout<<"\t\t INVENTARIO DE INSTRUMENTOS DE ORQUESTA"<<endl;
	cout<<"\t 1.Adicionar"<<endl;
	cout<<"\t 2.Buscar"<<endl;
	cout<<"\t 3.listar"<<endl;
	cout<<"\t 4.modificar"<<endl;
	cout<<"\t 5.Eliminar"<<endl;
	cout<<"\t 6.volver a menu"<<endl;
	cout<<"\t 0.Salir"<<endl;
	cout<<"\t opcion: ";
	cin>>opcion;
	switch(opcion)
	{
	case 1:
		cout<<"\t ingrese datos";
		adicionarRegistro("inventario.dat");
		break;
	case 2:
		break;
	case 3:
		listarArchivo("inventario.dat");
		break;
	case 4:
		break;
	case 5:
		break;
	case 6:
		break;
	case 0:
		cout<<"\t saliendo del programa";
		break;
	default:
		cout<<"\t opcion invalida";
		break;
	}
	}while(opcion!=0);

}
void datos(partituras dat) 
{	
	
	cout<<endl<< "Nombre:";
	do{
		getline(cin,dat.nom);
	}while(dat.nom.length() == 0);
	cout<< "codigo:";
	cin>> dat.codigo;
	cout<<"autor:";	
	do{
		getline(cin, dat.autor);
	}while(dat.autor.length() == 0);

	
}
void Registro(partituras dat, int nroReg)
{
	cout<<endl<<"   "<<nroReg<<".-"<< dat.nom<< "         "<<dat.codigo<< "    "<< dat.autor;
}
void adicionar(char Arch[15])
{
	FILE *ptr;
	partituras dat;
	ptr= fopen(Arch, "ab"); 
	datos(dat);
	fwrite(&dat, sizeof(struct partituras),1,ptr);
	fclose(ptr);
}

void listar(char Arch[15])
{
	FILE *ptr;
	partituras dat;
	int cont=0;
	ptr= fopen(Arch,"rb");
	if(ptr == NULL)
	{
		cout<< "EL archivo no existe...";
	}
	else
	{
		cout<<endl<<"   ** LISTADO DE INSTRUMENTOS **";
		cout<<endl<<" Nombre      codigo      autor";
		cout<<endl<<"----------------------------";
		fread(&dat, sizeof(struct partituras),1,ptr);
		while(!feof(ptr))
		{
			if("inventario.dat" == 0)
			{
				Registro(dat,cont+1);
			}
			fread(&dat, sizeof(struct partituras),1,ptr);
			cont++;
		}
		fclose(ptr);
	}
	cout<<endl;
	getch();
}


void part(partituras dat)
{
	int opcion;
	
	do{
	cout<<"\t\t PARTIDURAS"<<endl;
	cout<<"\t 1.Adicionar"<<endl;
	cout<<"\t 2.Buscar"<<endl;
	cout<<"\t 3.listar"<<endl;
	cout<<"\t 4.modificar"<<endl;
	cout<<"\t 5.Eliminar"<<endl;
	cout<<"\t 6.volver a menu"<<endl;
	cout<<"\t 0.Salir"<<endl;
	cout<<"\t opcion:";
	cin>>opcion;
	switch(opcion)
	{
	case 1:
		cout<<"\t ingrese datos";
		datos(dat);
		break;
	case 2:

		break;
	case 3:
	listar("inventario.dat");
		break;
	case 4:
		break;
	case 5:
		break;
	case 6:
		break;
	case 0:
		cout<<"\t saliendo del programa";
		break;
	default:
		cout<<"\t opcion invalida";
		break;
	}
	}while(opcion!=0);
	getch();

}
void main()
{
	int opcion;
	FILE *ptr;
	instrumento reg;
	partituras dat;
	ptr= fopen("inventario.dat", "wb");
	do{
	cout<<"\t\t ****MENU*****"<<endl;
	cout<<"\t 1.INSTRUMENTO"<<endl;
	cout<<"\t 2.PARTIDURAS"<<endl;
	cout<<"\t 3.VOLVER ATRAS"<<endl;
	cout<<"\t 0.salir del programa"<<endl;
	cout<<"\t opcion:";
	cin>>opcion;
	switch(opcion)
	{
	case 1:
		instru(reg);
		break;
	case 2:
		part(dat);
		break;
	case 3:
		//usuario(reg);
		break;
	case 0:
		cout<<"\t saliendo del programa";
		break;
	default:
		cout<<"\t opcion invalida";
		break;
	}
	}while(opcion!=0);
fclose(ptr);

	getch();

}

